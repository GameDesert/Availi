<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#EVENT# | Respond | Availi</title>
    <link rel="stylesheet" href="respond.css">
</head>

<body onload="main();">
    <header>
        <svg class="mainlogo" viewBox="0 0 512 151.13829" version="1.1" id="svg1" xml:space="preserve"
            xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
            <defs id="defs1" />
            <g transform="translate(1.342902,-180.03445)">
                <path id="text1"
                    style="font-weight:800;font-size:137.276px;line-height:1.25;font-family:Zain;-inkscape-font-specification:'Zain, Ultra-Bold';text-align:center;text-anchor:middle;stroke-width:1"
                    d="m 414.62523,180.03445 c -2.31837,0 -3.47865,1.16028 -3.47865,3.47863 v 110.20907 c 0,12.48344 2.67289,21.84621 8.02295,28.08795 5.35006,6.06338 12.6641,9.09624 21.93753,9.09624 7.1334,0 12.66298,-1.42454 16.58635,-4.27791 4.10172,-2.85335 6.95458,-6.4223 8.5596,-10.70233 1.78335,-4.28006 2.67558,-8.46937 2.67558,-12.57109 0,-0.89166 -0.26804,-1.78391 -0.80304,-2.67557 -0.35668,-0.89168 -1.07275,-1.3397 -2.14276,-1.3397 -0.71334,0 -1.33753,0.18005 -1.87253,0.53664 -0.535,0.17829 -0.97924,0.44638 -1.3359,0.80306 -1.78335,1.24834 -3.47594,2.22867 -5.08095,2.94198 -1.42668,0.71337 -3.39113,1.06948 -5.8878,1.06948 -6.77674,0 -10.16571,-4.81349 -10.16571,-14.4436 v -83.99744 c 0,-9.63009 -2.22869,-16.40424 -6.68707,-20.32761 -4.28005,-3.92337 -10.60998,-5.8878 -18.99173,-5.8878 z m -40.39262,2.67557 c -4.81505,1e-5 -8.9201,1.69642 -12.30845,5.08477 -3.21005,3.21002 -4.81455,7.31127 -4.81455,12.30464 0,4.9934 1.6045,9.09463 4.81455,12.30468 3.38835,3.21 7.4934,4.81452 12.30845,4.81452 4.63671,0 8.46991,-1.60452 11.50159,-4.81452 3.21005,-3.21005 4.81455,-7.31128 4.81455,-12.30468 0,-4.99337 -1.6045,-9.09462 -4.81455,-12.30464 -3.03168,-3.38835 -6.86488,-5.08477 -11.50159,-5.08477 z m 120.10835,0 c -4.81503,0 -8.91628,1.69642 -12.30464,5.08477 -3.21003,3.21002 -4.81836,7.31127 -4.81836,12.30464 0,4.9934 1.60833,9.09463 4.81836,12.30468 3.38836,3.21 7.48961,4.81452 12.30464,4.81452 4.6367,0 8.4699,-1.60452 11.50159,-4.81452 3.21003,-3.21005 4.81455,-7.31128 4.81455,-12.30468 0,-4.99337 -1.60452,-9.09462 -4.81455,-12.30464 -3.03169,-3.38835 -6.86489,-5.08476 -11.50159,-5.08477 z M 45.203938,223.36906 c -9.630089,0 -17.924476,2.40866 -24.879536,7.22369 -6.955061,4.63672 -12.3046872,11.05853 -16.0496988,19.26196 -3.74505064,8.02506 -5.6176052,17.03172 -5.6176052,27.01847 0,9.98677 1.6925773,19.08148 5.0809666,27.28489 3.5666908,8.20342 8.7401594,14.8014 15.5168804,19.79478 6.77672,4.81504 15.247265,7.21989 25.412354,7.21989 6.241719,0 11.947461,-1.24836 17.119196,-3.74506 5.171696,-2.4967 9.452917,-5.88185 12.841287,-10.16189 v 8.02294 c 0,2.31837 1.160304,3.47866 3.478651,3.47866 h 23.806237 c 2.31837,0 3.47865,-1.16029 3.47865,-3.47866 v -95.22881 c 0,-2.31835 -1.16028,-3.47863 -3.47865,-3.47863 h -1.33587 c -5.528401,0 -10.253837,0.80033 -14.177189,2.40535 -3.74505,1.60501 -6.601731,4.28173 -8.563397,8.02676 -3.031709,-3.38837 -7.221032,-6.50929 -12.571088,-9.36265 -5.171715,-2.85335 -11.857784,-4.28169 -20.061188,-4.28169 z m 231.657102,0 c -9.63009,0 -17.92447,2.40866 -24.87954,7.22369 -6.95506,4.63672 -12.30467,11.05853 -16.04971,19.26196 -3.74504,8.02506 -5.61759,17.03172 -5.61759,27.01847 0,9.98677 1.6964,19.08148 5.08476,27.28489 3.5667,8.20342 8.73634,14.8014 15.51307,19.79478 6.77672,4.81504 15.24726,7.21989 25.41237,7.21989 6.24172,2e-5 11.94748,-1.24836 17.1192,-3.74506 5.1717,-2.4967 9.45292,-5.88185 12.84128,-10.16189 v 8.02294 c 0,2.31837 1.16029,3.47866 3.47866,3.47866 h 23.80623 c 2.31837,0 3.47866,-1.16029 3.47866,-3.47866 v -95.22881 c 0,-2.31835 -1.16029,-3.47863 -3.47866,-3.47863 h -1.33587 c -5.52838,0 -10.25381,0.80033 -14.17719,2.40535 -3.74502,1.60501 -6.59791,4.28173 -8.5596,8.02676 -3.03168,-3.38837 -7.22483,-6.50929 -12.57488,-9.36265 -5.17171,-2.85335 -11.85779,-4.28169 -20.06119,-4.28169 z m -157.82918,3.21223 c -2.14,0 -2.76419,1.16028 -1.87252,3.47863 l 32.36964,95.22881 c 0.71335,2.31837 2.31785,3.47866 4.81454,3.47866 H 184.304 c 2.31836,0 3.83479,-1.16029 4.54813,-3.47866 l 32.90248,-95.22881 c 0.71334,-2.31835 -0.0908,-3.47863 -2.40916,-3.47863 h -24.60932 c -2.31837,0 -3.74291,1.16028 -4.27789,3.47863 L 169.59018,300.94586 155.413,252.7967 c -1.96169,-7.1334 -4.19038,-12.57491 -6.68707,-16.31994 -2.49669,-3.74503 -5.70568,-6.32986 -9.62905,-7.75654 -3.74504,-1.42668 -8.73853,-2.13893 -14.98025,-2.13893 z m 243.16252,0 c -2.31836,0 -3.47865,1.16028 -3.47865,3.47863 v 95.22881 c 0,2.31837 1.16029,3.47866 3.47865,3.47866 h 23.53982 c 2.31837,0 3.47865,-1.16029 3.47865,-3.47866 V 252.7967 c 0,-9.63008 -2.23248,-16.40804 -6.69086,-20.33141 -4.28004,-3.92339 -10.60999,-5.884 -18.99173,-5.884 z m 120.10835,0 c -2.31837,0 -3.47865,1.16028 -3.47865,3.47863 v 95.22881 c 0,2.31837 1.16028,3.47866 3.47865,3.47866 h 23.53982 c 2.31834,0 3.47865,-1.16029 3.47865,-3.47866 V 252.7967 c 0,-9.63008 -2.22869,-16.40804 -6.68706,-20.33141 -4.28003,-3.92339 -10.61379,-5.884 -18.99553,-5.884 z m -197.68515,26.48183 c 2.49671,0 5.43765,0.53611 8.82602,1.60612 3.38835,0.89168 6.3331,3.03227 8.82982,6.42063 2.67502,3.38838 4.01146,8.73799 4.01146,16.04972 0,7.31173 -1.33644,12.83751 -4.01146,16.58256 -2.67503,3.56669 -5.70787,5.97536 -9.09624,7.22371 -3.38837,1.07 -6.24124,1.60609 -8.5596,1.60609 -2.31836,0 -5.3512,-0.53609 -9.09624,-1.60609 -3.56669,-1.24835 -6.77571,-3.65702 -9.62907,-7.22371 -2.675,-3.74505 -4.01147,-9.27083 -4.01147,-16.58256 0,-7.31173 1.42454,-12.66134 4.27789,-16.04972 2.85337,-3.38836 6.06618,-5.52895 9.63287,-6.42063 3.56671,-1.07001 6.50766,-1.60612 8.82602,-1.60612 z m -232.281274,3.17797 a 21.530006,21.530006 0 0 1 21.530295,21.5303 21.530006,21.530006 0 0 1 -21.530295,21.53029 21.530006,21.530006 0 0 1 -21.530295,-21.53029 21.530006,21.530006 0 0 1 21.530295,-21.5303 z m -2.690812,8.07243 v 16.14868 l 14.127708,8.47586 2.020963,-3.30738 -12.110563,-7.18565 v -14.13151 z" />
            </g>
        </svg>
        <!-- EVENT TITLE + USER -->
    </header>
    <section>
        <!-- INFO BOX -->
        <!-- EVENT TIME -->
        <!-- CALENDAR SQUARES -->
        <div class="squares" id="calendar">
            <!-- <div class="eventblock">
                <p class="daytext">20 AUG</p>
                <div class="date block">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <title>Blocked</title>
                        <path
                            d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
                    </svg>
                </div>
            </div>
            <div class="eventblock">
                <p class="daytext">21 AUG</p>
                <div class="date tentative">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <title>Tentative</title>
                        <path
                            d="M2,15C2,15 2,9 8,9C12,9 12.5,12.5 15.5,12.5C19.5,12.5 19.5,9 19.5,9H22C22,9 22,15 16,15C12,15 10.5,11.5 8.5,11.5C4.5,11.5 4.5,15 4.5,15H2" />
                    </svg>
                </div>
            </div>
            <div class="eventblock">
                <p class="daytext">22 AUG</p>
                <div class="date free">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <title>Free</title>
                        <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
                    </svg>
                </div>
            </div>
            <div class="eventblock">
                <p class="daytext">23 AUG</p>
                <div class="date disabled">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <title>Disabled</title>
                        <path
                            d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" />
                    </svg>
                </div>
            </div>
            <div class="eventblock">
                <p class="daytext">24 AUG</p>
                <div class="date unselected">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <title>Unselected</title>
                        <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
                    </svg>
                </div>
            </div>
            <div class="eventblock">
                <p class="daytext">25 AUG</p>
                <div class="date final">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <title>Final</title>
                        <path
                            d="M14.53 1.45L13.45 2.53L15.05 4.13C15.27 4.38 15.38 4.67 15.38 5S15.27 5.64 15.05 5.86L11.5 9.47L12.5 10.55L16.13 6.94C16.66 6.35 16.92 5.7 16.92 5C16.92 4.3 16.66 3.64 16.13 3.05L14.53 1.45M10.55 3.47L9.47 4.55L10.08 5.11C10.3 5.33 10.41 5.63 10.41 6S10.3 6.67 10.08 6.89L9.47 7.45L10.55 8.53L11.11 7.92C11.64 7.33 11.91 6.69 11.91 6C11.91 5.28 11.64 4.63 11.11 4.03L10.55 3.47M21 5.06C20.31 5.06 19.67 5.33 19.08 5.86L13.45 11.5L14.53 12.5L20.11 6.94C20.36 6.69 20.66 6.56 21 6.56S21.64 6.69 21.89 6.94L22.5 7.55L23.53 6.47L22.97 5.86C22.38 5.33 21.72 5.06 21 5.06M7 8L2 22L16 17L7 8M19 11.06C18.3 11.06 17.66 11.33 17.06 11.86L15.47 13.45L16.55 14.53L18.14 12.94C18.39 12.69 18.67 12.56 19 12.56C19.33 12.56 19.63 12.69 19.88 12.94L21.5 14.53L22.55 13.5L20.95 11.86C20.36 11.33 19.7 11.06 19 11.06Z" />
                    </svg>
                </div>
            </div> -->
        </div>
    </section>
    <footer>
        <!-- SUMMARY -->
        <!-- SUBMIT -->
    </footer>

    <script>
        vectors = {
            "block": '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Blocked</title><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>',
            "tentative": '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Tentative</title><path d="M2,15C2,15 2,9 8,9C12,9 12.5,12.5 15.5,12.5C19.5,12.5 19.5,9 19.5,9H22C22,9 22,15 16,15C12,15 10.5,11.5 8.5,11.5C4.5,11.5 4.5,15 4.5,15H2" /></svg>',
            "free": '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Free</title><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" /></svg>',
            "disabled": '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Disabled</title><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>',
            "unselected": '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Unselected</title><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" /></svg>',
            "final": '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Final</title><path d="M14.53 1.45L13.45 2.53L15.05 4.13C15.27 4.38 15.38 4.67 15.38 5S15.27 5.64 15.05 5.86L11.5 9.47L12.5 10.55L16.13 6.94C16.66 6.35 16.92 5.7 16.92 5C16.92 4.3 16.66 3.64 16.13 3.05L14.53 1.45M10.55 3.47L9.47 4.55L10.08 5.11C10.3 5.33 10.41 5.63 10.41 6S10.3 6.67 10.08 6.89L9.47 7.45L10.55 8.53L11.11 7.92C11.64 7.33 11.91 6.69 11.91 6C11.91 5.28 11.64 4.63 11.11 4.03L10.55 3.47M21 5.06C20.31 5.06 19.67 5.33 19.08 5.86L13.45 11.5L14.53 12.5L20.11 6.94C20.36 6.69 20.66 6.56 21 6.56S21.64 6.69 21.89 6.94L22.5 7.55L23.53 6.47L22.97 5.86C22.38 5.33 21.72 5.06 21 5.06M7 8L2 22L16 17L7 8M19 11.06C18.3 11.06 17.66 11.33 17.06 11.86L15.47 13.45L16.55 14.53L18.14 12.94C18.39 12.69 18.67 12.56 19 12.56C19.33 12.56 19.63 12.69 19.88 12.94L21.5 14.53L22.55 13.5L20.95 11.86C20.36 11.33 19.7 11.06 19 11.06Z" /></svg>'
        }

        date_template = `<div class="eventblock" id="{DAYFULL}"><p class="daytext">{DAY}</p><div class="date {TYPE CLASS}">{VECTOR}</div></div>`

        function formatDate(date) {
            const day = new Date(date);

            const monthNames = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];

            const month = monthNames[day.getMonth()];

            const daynum = day.getDate();

            return `${daynum} ${month}`;
        }

        function addSquare(day, type_name) {
            const element = date_template.replace("{TYPE CLASS}", type_name).replace("{VECTOR}", vectors[type_name]).replace("{DAY}", formatDate(day)).replace("{DAYFULL}", day);

            const cal = document.getElementById('calendar');
            cal.innerHTML += element;
        }

        function b_or_t(dates, date) {
            console.log(dates[date].b)
            console.log(dates[date].t)
            if (dates[date].b.length != 0) {
                console.log("BLOCK")
                return "block"
            } else if (dates[date].t.length != 0) {
                console.log("TENTATIVE")
                return "tentative"
            } else {
                console.log("FREE")
                return "free"
            }
        }

        function create_tiles(id) {
            
            url = `http://localhost:3000/api?id=${id}`;

            let request = new XMLHttpRequest();
            request.open('GET', url, false);
            request.setRequestHeader('Content-Type', 'application/json');
            request.send();
            data = JSON.parse(request.responseText.replace(`\"`, `"`));

            console.log(data);
            console.log(JSON.parse(data.dates));

            const keys = Object.keys(JSON.parse(data.dates));
            console.log(keys);

            for (let i = 0; i < keys.length; i++) {
                const date = keys[i];
                const type = b_or_t(JSON.parse(data.dates), date);
                addSquare(date, type);
            }
        }

        function main() {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');

            if (id) {
                console.log(id)
                if ((/[a-z]+-[a-z]+-[a-z]+/gm.test(id))) {
                    create_tiles(id);
                } else {
                    alert("Event ID not recognised. Are you sure you followed a valid link?")
                }
            } else {
                alert("Event ID not present. Are you sure you followed a valid link?")
            }
        }
    </script>
</body>

</html>